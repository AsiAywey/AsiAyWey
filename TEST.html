<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MatchFlow - Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Inter', sans-serif;
            background: #0b0b0d;
            color: #fff;
            padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { color: #ff3b3b; margin-bottom: 20px; }
        .test-item {
            background: #1a1a1f;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #ff3b3b;
            border-radius: 4px;
        }
        .test-item.success { border-left-color: #28a745; }
        .test-item.error { border-left-color: #dc3545; }
        .status { font-weight: bold; margin-left: 10px; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .pending { color: #ffc107; }
        button { 
            background: #ff3b3b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover { background: #e63030; }
        code {
            background: #252529;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üß™ MatchFlow - Test Panel</h1>
    
    <div class="test-item">
        <strong>1. Verificar json-server</strong>
        <span class="status" id="test1">‚è≥ Checking...</span>
    </div>

    <div class="test-item">
        <strong>2. Conectar API - Candidates</strong>
        <span class="status" id="test2">‚è≥ Checking...</span>
    </div>

    <div class="test-item">
        <strong>3. Conectar API - Companies</strong>
        <span class="status" id="test3">‚è≥ Checking...</span>
    </div>

    <div class="test-item">
        <strong>4. Conectar API - Job Offers</strong>
        <span class="status" id="test4">‚è≥ Checking...</span>
    </div>

    <div class="test-item">
        <strong>5. localStorage API</strong>
        <span class="status" id="test5">‚úÖ OK</span>
        <p style="margin-top: 10px; color: #aaa;">localStorage est√° disponible en el navegador</p>
    </div>

    <div class="test-item">
        <strong>6. Archivos JavaScript</strong>
        <span class="status" id="test6">‚úÖ OK</span>
        <ul style="margin-top: 10px; color: #aaa; list-style: none;">
            <li>‚úì login.js</li>
            <li>‚úì dashboard.js</li>
            <li>‚úì candidate.js</li>
            <li>‚úì jobs.js</li>
            <li>‚úì company.js</li>
            <li>‚úì api.js</li>
            <li>‚úì cache.js</li>
        </ul>
    </div>

    <div id="results" style="margin-top: 20px; padding: 15px; background: #1a1a1f; border-radius: 6px;">
        <h3>Resultado Final:</h3>
        <p id="finalResult" style="color: #ffc107; margin-top: 10px;">Ejecutando pruebas...</p>
    </div>

    <button onclick="location.href='login.html'">üöÄ Ir a Login</button>
</div>

<script>
const API_BASE = 'http://localhost:3001';

async function runTests() {
    try {
        // Test 1: json-server
        const t1 = await fetch(`${API_BASE}/candidates`);
        const test1 = document.getElementById('test1');
        if (t1.ok) {
            test1.textContent = '‚úÖ OK';
            test1.className = 'status success';
        } else {
            test1.textContent = '‚ùå FAIL';
            test1.className = 'status error';
            test1.innerHTML += '<br><small>json-server no responde. Revisa que est√© corriendo en puerto 3001</small>';
        }

        // Test 2: Candidates
        const candidates = await t1.json();
        const test2 = document.getElementById('test2');
        test2.textContent = `‚úÖ OK (${candidates.length} candidatos)`;
        test2.className = 'status success';

        // Test 3: Companies
        const t3 = await fetch(`${API_BASE}/companies`);
        const companies = await t3.json();
        const test3 = document.getElementById('test3');
        test3.textContent = `‚úÖ OK (${companies.length} empresas)`;
        test3.className = 'status success';

        // Test 4: Job Offers
        const t4 = await fetch(`${API_BASE}/jobOffers`);
        const offers = await t4.json();
        const test4 = document.getElementById('test4');
        test4.textContent = `‚úÖ OK (${offers.length} ofertas)`;
        test4.className = 'status success';

        // Final result
        const finalResult = document.getElementById('finalResult');
        finalResult.textContent = '‚úÖ ¬°Todo est√° listo! Puedes ir al login.';
        finalResult.style.color = '#28a745';

    } catch (err) {
        console.error('Test error:', err);
        const finalResult = document.getElementById('finalResult');
        finalResult.textContent = `‚ùå Error: ${err.message}`;
        finalResult.style.color = '#dc3545';
        finalResult.innerHTML += '<br><small>Aseg√∫rate de que json-server est√© corriendo: <code>json-server --watch general/db.json --port 3001</code></small>';
    }
}

// Run tests on load
window.addEventListener('load', runTests);
</script>

</body>
</html>
